<div class="card">
    <div class="card-header bg-success text-white">
        <h5 class="card-title mb-0">Login</h5>
    </div>
    <div class="card-body">
        <form hx-post="{% url 'login' %}"
              hx-target="#login-result-container"
              hx-swap="innerHTML"
              hx-indicator="#login-indicator">
            {% csrf_token %}

            <div class="mb-3">
                <label for="{{ form.username.id_for_label }}" class="form-label">{{ form.username.label }}</label>
                {{ form.username }}
                {% if form.username.errors %}
                <div class="text-danger">
                    {% for error in form.username.errors %}
                        {{ error }}
                    {% endfor %}
                </div>
                {% endif %}
            </div>

            <div class="mb-3">
                <label for="{{ form.password.id_for_label }}" class="form-label">{{ form.password.label }}</label>
                {{ form.password }}
                {% if form.password.errors %}
                <div class="text-danger">
                    {% for error in form.password.errors %}
                        {{ error }}
                    {% endfor %}
                </div>
                {% endif %}
            </div>

            <div class="d-grid">
                <button type="submit" class="btn btn-success">
                    <span class="spinner-border spinner-border-sm d-none" id="login-indicator" role="status" aria-hidden="true"></span>
                    Login
                </button>
            </div>
        </form>

        <div id="login-result-container" class="mt-3"></div>
    </div>
</div>

<script>
    document.addEventListener('htmx:afterRequest', function(event) {
        const connectionMessage = '{{ connection_message }}';
        if (connectionMessage && connectionMessage !== '') {
            const isSuccess = true;  // Login form means connection was successful
            showToast(connectionMessage, isSuccess);
        }
    });
</script>