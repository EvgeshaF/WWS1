{% extends 'base.html' %}
{% load static %}
{% load company_extras %}

{% block content %}
    <div class="container-fluid p-4">

        <!-- Карточки действий - ОДИНАКОВЫЕ для всех -->
        <div class="row g-4 mb-4">
            <div class="col-12 mb-3">
                <h4><i class="bi bi-grid-3x3-gap me-2"></i>Systemfunktionen</h4>
            </div>

            <!-- Регистрация компании (только если нет компании) -->
            {% if not has_company %}
                <div class="col-lg-4 col-md-6">
                    <div class="action-card border-warning">
                        <div class="action-header">
                            <i class="bi bi-building-add text-warning"></i>
                            <h5>Firma registrieren</h5>
                        </div>
                        <p class="action-text">
                            Registrieren Sie Ihre Firma als primäres Unternehmen im System.
                        </p>
                        {% if is_authenticated %}
                            <a href="{% url 'company:register_company' %}" class="action-btn btn btn-warning">
                                <i class="bi bi-building-add me-1"></i>
                                Jetzt registrieren
                            </a>
                        {% else %}
                            <button type="button" class="btn btn-outline-warning" onclick="window.showLoginModal && window.showLoginModal()">
                                <i class="bi bi-lock me-1"></i>
                                Anmeldung erforderlich
                            </button>
                        {% endif %}
                    </div>
                </div>
            {% endif %}

            <!-- Lagerverwaltung -->
            <div class="col-lg-4 col-md-6">
                <div class="action-card">
                    <div class="action-header">
                        <i class="bi bi-box-seam"></i>
                        <h5>Lagerverwaltung</h5>
                    </div>
                    <p class="action-text">
                        Verwalten Sie Ihr Lager, fügen Sie Produkte hinzu und verfolgen Sie Bestände.
                    </p>
                    {% if is_authenticated %}
                        <a href="#" class="action-btn btn btn-primary">
                            <i class="bi bi-arrow-right me-1"></i>
                            Lager öffnen
                        </a>
                    {% else %}
                        <button type="button" class="action-btn btn btn-outline-primary" onclick="window.showLoginModal && window.showLoginModal()">
                            <i class="bi bi-lock me-1"></i>
                            Anmeldung erforderlich
                        </button>
                    {% endif %}
                </div>
            </div>

            <!-- Benutzerverwaltung -->
            <div class="col-lg-4 col-md-6">
                <div class="action-card">
                    <div class="action-header">
                        <i class="bi bi-people"></i>
                        <h5>Benutzerverwaltung</h5>
                    </div>
                    <p class="action-text">
                        Verwalten Sie Benutzerkonten, Berechtigungen und Zugriffe.
                    </p>
                    {% if is_authenticated %}
                        <a href="{% url 'users:create_admin_step1' %}" class="action-btn btn btn-primary">
                            <i class="bi bi-arrow-right me-1"></i>
                            Benutzer verwalten
                        </a>
                    {% else %}
                        <button type="button" class="action-btn btn btn-outline-primary" onclick="window.showLoginModal && window.showLoginModal()">
                            <i class="bi bi-lock me-1"></i>
                            Anmeldung erforderlich
                        </button>
                    {% endif %}
                </div>
            </div>

            <!-- Berichte -->
            <div class="col-lg-4 col-md-6">
                <div class="action-card">
                    <div class="action-header">
                        <i class="bi bi-graph-up"></i>
                        <h5>Berichte</h5>
                    </div>
                    <p class="action-text">
                        Erstellen Sie detaillierte Berichte über Lagerbestände und Bewegungen.
                    </p>
                    {% if is_authenticated %}
                        <a href="#" class="action-btn btn btn-primary">
                            <i class="bi bi-arrow-right me-1"></i>
                            Berichte öffnen
                        </a>
                    {% else %}
                        <button type="button" class="action-btn btn btn-outline-primary" onclick="window.showLoginModal && window.showLoginModal()">
                            <i class="bi bi-lock me-1"></i>
                            Anmeldung erforderlich
                        </button>
                    {% endif %}
                </div>
            </div>

            <!-- Systemeinstellungen -->
            <div class="col-lg-4 col-md-6">
                <div class="action-card">
                    <div class="action-header">
                        <i class="bi bi-gear"></i>
                        <h5>Systemeinstellungen</h5>
                    </div>
                    <p class="action-text">
                        Konfigurieren Sie Systemparameter und Sicherheitseinstellungen.
                    </p>
                    {% if is_authenticated %}
                        <a href="#" class="action-btn btn btn-primary">
                            <i class="bi bi-arrow-right me-1"></i>
                            Einstellungen öffnen
                        </a>
                    {% else %}
                        <button type="button" class="action-btn btn btn-outline-primary" onclick="window.showLoginModal && window.showLoginModal()">
                            <i class="bi bi-lock me-1"></i>
                            Anmeldung erforderlich
                        </button>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Информационные карточки - ОДИНАКОВЫЕ для всех -->
        <div class="row g-4">
            <div class="col-12 mb-3">
                <h4><i class="bi bi-info-circle me-2"></i>Systeminformationen</h4>
            </div>

            <!-- Systemstatus -->
            <div class="col-lg-4 col-md-6">
                <div class="info-card">
                    <div class="info-header">
                        <i class="bi bi-activity text-success"></i>
                        <h5>Systemstatus</h5>
                    </div>
                    <div class="status-item">
                        <i class="bi bi-database text-success"></i>
                        <span>MongoDB</span>
                        <span class="text-success">{{ mongodb_status|default:"Aktiv" }}</span>
                    </div>
                    <div class="status-item">
                        <i class="bi bi-people text-{% if admin_count > 0 %}success{% else %}warning{% endif %}"></i>
                        <span>Administratoren</span>
                        <span class="text-{% if admin_count > 0 %}success{% else %}warning{% endif %}">
                            {{ admin_count|default:0 }} registriert
                        </span>
                    </div>
                    <div class="status-item">
                        <i class="bi bi-building text-{% if has_company %}success{% else %}warning{% endif %}"></i>
                        <span>Firma</span>
                        <span class="text-{% if has_company %}success{% else %}warning{% endif %}">
                            {% if has_company %}{{ company_name }}{% else %}Nicht registriert{% endif %}
                        </span>
                    </div>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="col-lg-4 col-md-6">
                <div class="info-card">
                    <div class="info-header">
                        <i class="bi bi-lightning text-primary"></i>
                        <h5>Quick Links</h5>
                    </div>
                    <a href="{% url 'create_database_step1' %}" class="quick-link">
                        <i class="bi bi-database-gear"></i>
                        <span>Datenbank konfigurieren</span>
                        <i class="bi bi-arrow-right"></i>
                    </a>
                    <a href="{% url 'users:create_admin_step1' %}" class="quick-link">
                        <i class="bi bi-person-plus"></i>
                        <span>Administrator erstellen</span>
                        <i class="bi bi-arrow-right"></i>
                    </a>
                    <a href="{% url 'company:register_company' %}" class="quick-link">
                        <i class="bi bi-building-add"></i>
                        <span>Firma registrieren</span>
                        <i class="bi bi-arrow-right"></i>
                    </a>
                    <a href="{% url 'company:company_info' %}" class="quick-link">
                        <i class="bi bi-info-circle"></i>
                        <span>Firmeninfo anzeigen</span>
                        <i class="bi bi-arrow-right"></i>
                    </a>
                </div>
            </div>

            <!-- Hilfe und Support -->
            <div class="col-lg-4 col-md-6">
                <div class="info-card">
                    <div class="info-header">
                        <i class="bi bi-question-circle text-info"></i>
                        <h5>Hilfe & Support</h5>
                    </div>
                    <a href="#" class="quick-link">
                        <i class="bi bi-book"></i>
                        <span>Dokumentation</span>
                        <i class="bi bi-arrow-right"></i>
                    </a>
                    <a href="#" class="quick-link">
                        <i class="bi bi-chat-dots"></i>
                        <span>Support kontaktieren</span>
                        <i class="bi bi-arrow-right"></i>
                    </a>
                    <a href="#" class="quick-link">
                        <i class="bi bi-question-circle"></i>
                        <span>FAQ</span>
                        <i class="bi bi-arrow-right"></i>
                    </a>
                    <a href="#" class="quick-link">
                        <i class="bi bi-tools"></i>
                        <span>System-Diagnose</span>
                        <i class="bi bi-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}