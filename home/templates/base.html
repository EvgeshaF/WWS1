{% load static %}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}WWS1{% endblock %}</title>

    <link rel="icon" href="{% static 'defaults/img/favicon.ico' %}">
    <link rel="apple-touch-icon" href="{% static 'defaults/img/apple-touch-icon.png' %}">
    <link rel="apple-touch-icon-precomposed" href="{% static 'defaults/img/apple-touch-icon-precomposed.png' %}">

    <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'bootstrap/icons/bootstrap-icons.css' %}">

    <link rel="stylesheet" href="{% static 'select2/dist/css/select2.min.css' %}">
    <link rel="stylesheet" href="{% static 'select2-bootstrap-5-theme/select2-bootstrap-5-theme.min.css' %}">

    <link rel="stylesheet" href="{% static 'css/layout-heights.css' %}">
    <link rel="stylesheet" href="{% static 'css/main_styles.css' %}">
    <link rel="stylesheet" href="{% static 'css/sidebar.css' %}">
    <link rel="stylesheet" href="{% static 'css/components.css' %}">
    <link rel="stylesheet" href="{% static 'css/toasts.css' %}">

    <!-- –ù–û–í–û–ï: –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
    {% if show_login_modal or requires_auth %}
    <link rel="stylesheet" href="{% static 'css/login_modal.css' %}">
    {% endif %}

    {% block extra_css %}{% endblock %}
</head>
<body class="modern-body"{% if show_login_modal %} data-show-login="true"{% endif %}>

<!-- –í–µ—Ä—Ö–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
{% block navbar %}
    {% include 'navbar.html' %}
{% endblock %}

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª—å—é –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º -->
<div class="main-container d-flex">
    <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) -->
    {% block navmenu %}
        {% if is_authenticated %}
            {% include 'sidebar.html' %}
        {% endif %}
    {% endblock %}

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="main-content flex-grow-1{% if not is_authenticated %} no-sidebar{% endif %}">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
        {% block header_section %}
{#            <header class="main-header">#}
{#                <div class="header-content">#}
{#                    <h1 class="header-title">{% block header %}WWS1{% endblock %}</h1>#}
{#                    <p class="header-subtitle">{% block subtitle %}Warehouse Management System{% endblock %}</p>#}
{#                </div>#}
{#            </header>#}
        {% endblock %}

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
        <main class="content-wrapper">
            {% block content %}{% endblock %}
        </main>

        <!-- –ü–æ–¥–≤–∞–ª -->
        <footer class="main-footer">
            <div class="footer-content">
                <p class="text-muted text-center">
                    &copy; 2025 EF-SOFT
                </p>
            </div>
        </footer>
    </div>
</div>

<!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–æ—Å—Ç–æ–≤ -->
<div id="toast-container"></div>

<!-- –ù–û–í–û–ï: –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) -->
{% if show_login_modal or requires_auth %}
    {% include 'login_modal.html' %}
{% endif %}

<!-- –°–∫—Ä—ã—Ç—ã–µ Django —Å–æ–æ–±—â–µ–Ω–∏—è -->
<div id="django-messages" style="display: none;">
    {% for message in messages %}
        <div data-tags="{{ message.tags }}" data-text="{{ message|force_escape }}" data-delay="5000"></div>
    {% endfor %}
</div>

<!-- –ù–û–í–û–ï: JavaScript –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
{% if show_login_modal or requires_auth %}
<script src="{% static 'js/login_modal.js' %}"></script>
{% endif %}

<script src="{% static 'js/toasts.js' %}"></script>

<script src="{% static 'bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<!-- jQuery (—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è Select2) -->
<script src="{% static 'jquery/jquery-3.7.1.min.js' %}"></script>
<!-- Select2 JS -->
<script src="{% static 'select2/dist/js/select2.min.js' %}"></script>
<script src="{% static 'select2/dist/js/i18n/de.js' %}"></script>

<script src="{% static 'htmx/js/htmx.min.js' %}"></script>

<!-- Sidebar —Å–∫—Ä–∏–ø—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
{% if is_authenticated %}
<script src="{% static 'js/sidebar.js' %}"></script>
{% endif %}

{% if show_login_modal or requires_auth %}
<script src="{% static 'js/login_modal.js' %}"></script>
{% endif %}

<script>
    // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    window.currentUser = {% if current_user %}{{ current_user|safe }}{% else %}null{% endif %};
    window.isAuthenticated = {{ is_authenticated|yesno:"true,false" }};
    window.requiresAuth = {{ requires_auth|yesno:"true,false" }};
    window.systemInfo = {{ system_info|safe }};
    window.showLoginModal = {{ show_login_modal|yesno:"true,false" }};

    // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    function showLoginModal() {
        if (window.loginModal) {
            window.loginModal.showModal();
        } else {
            console.error('Login modal –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        }
    }
</script>

{% block extra_js %}{% endblock %}
</body>
</html>

<!-- –ù–û–í–û–ï: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –º–∞–∫–µ—Ç–∞ –±–µ–∑ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ -->
<style>
.main-content.no-sidebar {
    margin-left: 0 !important;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
.navbar-public {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-dark) 100%) !important;
}

.navbar-public .navbar-brand {
    color: white !important;
    font-weight: 700;
}

.navbar-public .nav-link {
    color: rgba(255, 255, 255, 0.85) !important;
}

.navbar-public .nav-link:hover {
    color: white !important;
}

/* –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –Ω–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π */
.public-layout .welcome-section {
    margin-top: 2rem;
}

.public-layout .container-fluid {
    max-width: 1200px;
}

/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ */
.auth-required .action-card,
.auth-required .info-card {
    opacity: 0.7;
    pointer-events: none;
    position: relative;
}

.auth-required .action-card::after,
.auth-required .info-card::after {
    content: 'üîí Anmeldung erforderlich';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(13, 110, 253, 0.9);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.85rem;
    font-weight: 600;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}
</style>
